<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Hospital IN/OUT dates — hospital_in_out_dates • epidm</title><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Hospital IN/OUT dates — hospital_in_out_dates"><meta name="description" content='
Derives per‑patient hospital entry (hospital_in) and exit (hospital_out)
dates by reconciling A&amp;amp;E (ECDS) attendances and inpatient (HES/SUS) spells.
Applies a simple ranking to determine the most relevant hospital period around
an index event date (e.g., a specimen collection date).

"1"
Current admissions take priority

"2"
When conflicting on the same day, inpatient admissions take priority over A&amp;amp;E emergency care data

"3"
Where a patient has a linked A&amp;amp;E admission to a hospital inpatient stay, the A&amp;amp;E admission date is used

"4"
Where a patient has a positive test between two hospital stays the most recent completed hospital stay prior to the test is retained except if the time between these events is greater than 14 days, then the first admission following the test is retained



'><meta property="og:description" content='
Derives per‑patient hospital entry (hospital_in) and exit (hospital_out)
dates by reconciling A&amp;amp;E (ECDS) attendances and inpatient (HES/SUS) spells.
Applies a simple ranking to determine the most relevant hospital period around
an index event date (e.g., a specimen collection date).

"1"
Current admissions take priority

"2"
When conflicting on the same day, inpatient admissions take priority over A&amp;amp;E emergency care data

"3"
Where a patient has a linked A&amp;amp;E admission to a hospital inpatient stay, the A&amp;amp;E admission date is used

"4"
Where a patient has a positive test between two hospital stays the most recent completed hospital stay prior to the test is retained except if the time between these events is greater than 14 days, then the first admission following the test is retained



'><meta property="og:image" content="/logo.png"><meta name="twitter:card" content="summary"><meta name="twitter:creator" content="@alexbhatt"><meta name="twitter:site" content="@alexbhatt"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">epidm</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.6</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/epidm-function-usage.html">Guide: Staged Patient Matching and Time-based Episode Grouping with EpiDM</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ukhsa-collaboration/epidm/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Hospital IN/OUT dates</h1>
      <small class="dont-index">Source: <a href="https://github.com/ukhsa-collaboration/epidm/blob/master/R/hospital_in_out_dates.R" class="external-link"><code>R/hospital_in_out_dates.R</code></a></small>
      <div class="d-none name"><code>hospital_in_out_dates.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental" class="external-link"><img src="figures/lifecycle-experimental.svg" alt="[Experimental]"></a></p>
<p>Derives per‑patient <strong>hospital entry (<code>hospital_in</code>)</strong> and <strong>exit (<code>hospital_out</code>)</strong>
dates by reconciling A&amp;E (ECDS) attendances and inpatient (HES/SUS) spells.
Applies a simple ranking to determine the most relevant hospital period around
an index event date (e.g., a specimen collection date).</p>
<dl><dt>"1"</dt>
<dd><p>Current admissions take priority</p></dd>

<dt>"2"</dt>
<dd><p>When conflicting on the same day, inpatient admissions take priority over A&amp;E emergency care data</p></dd>

<dt>"3"</dt>
<dd><p>Where a patient has a linked A&amp;E admission to a hospital inpatient stay, the A&amp;E admission date is used</p></dd>

<dt>"4"</dt>
<dd><p>Where a patient has a positive test between two hospital stays the most recent completed hospital stay prior to the test is retained except if the time between these events is greater than 14 days, then the first admission following the test is retained</p></dd>


</dl></div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">hospital_in_out_dates</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  person_id <span class="op">=</span> <span class="st">"id"</span>,</span>
<span>  hospital <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>org_code <span class="op">=</span> <span class="st">"organisation_code_of_provider"</span>, event_date <span class="op">=</span> <span class="st">"ev_date"</span>,</span>
<span>    ae_arrive <span class="op">=</span> <span class="st">"arrival_date"</span>, ae_depart <span class="op">=</span> <span class="st">"departure_date"</span>, ae_discharge <span class="op">=</span></span>
<span>    <span class="st">"ecds_discharge"</span>, in_spell_start <span class="op">=</span> <span class="st">"spell_start_date"</span>, in_spell_end <span class="op">=</span></span>
<span>    <span class="st">"spell_end_date"</span>, in_discharge <span class="op">=</span> <span class="st">"discharge_destination"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A linked table containing A&amp;E and inpatient records (typically the
output of <code><a href="link_ae_inpatient.html">link_ae_inpatient()</a></code>), including person/event identifiers and
date fields.</p></dd>


<dt id="arg-person-id">person_id<a class="anchor" aria-label="anchor" href="#arg-person-id"></a></dt>
<dd><p>Quoted column name for the unique patient identifier.</p></dd>


<dt id="arg-hospital">hospital<a class="anchor" aria-label="anchor" href="#arg-hospital"></a></dt>
<dd><p>A named <strong>list</strong> specifying column names (all quoted) for:</p><dl><dt><code>org_code</code></dt>
<dd><p>Organisation code (optional; used to scope grouping).</p></dd>

<dt><code>event_date</code></dt>
<dd><p>Index date to compare against (e.g., <code>specimen_date</code>).</p></dd>

<dt><code>ae_arrive</code></dt>
<dd><p>ECDS arrival date.</p></dd>

<dt><code>ae_depart</code></dt>
<dd><p>ECDS departure date.</p></dd>

<dt><code>ae_discharge</code></dt>
<dd><p>ECDS discharge status (use grouped values if available).</p></dd>

<dt><code>in_spell_start</code></dt>
<dd><p>Inpatient spell start date.</p></dd>

<dt><code>in_spell_end</code></dt>
<dd><p>Inpatient spell end date.</p></dd>

<dt><code>in_discharge</code></dt>
<dd><p>Inpatient discharge destination (grouped recommended).</p></dd>


</dl></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>data.table</code> equal to <code>data</code> with additional columns:</p><dl><dt><code>hospital_in</code></dt>
<dd><p>Derived hospital admission date for the relevant stay.</p></dd>

<dt><code>hospital_out</code></dt>
<dd><p>Derived hospital discharge date for the relevant stay.</p></dd>

<dt><code>hospital_event_rank</code></dt>
<dd><p>Rank of suitability of the hospital window for the
given person/event (1 = most suitable).</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="workflow-context">Workflow context<a class="anchor" aria-label="anchor" href="#workflow-context"></a></h2>


<p>Use <code>hospital_in_out_dates()</code> <strong>after</strong>:</p><ul><li><p>Linking A&amp;E to inpatient spells (e.g., via <code><a href="link_ae_inpatient.html">link_ae_inpatient()</a></code>),</p></li>
<li><p>Constructing spells (e.g., <code><a href="group_time.html">group_time()</a></code> or <code><a href="cip_spells.html">cip_spells()</a></code>),</p></li>
<li><p>Optional code standardisation (e.g., discharge groups
via <code><a href="lookup_recode.html">lookup_recode()</a></code>)</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>epidm::lookup_recode()</p>
<p>epidm::group_time()</p>
<p>epidm::cip_spells()</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="fu">hospital_in_out_dates</span><span class="op">(</span><span class="va">link</span>,</span></span>
<span class="r-in"><span>person_id <span class="op">=</span> <span class="st">'id'</span>,</span></span>
<span class="r-in"><span>hospital <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  org_code <span class="op">=</span> <span class="st">'organisation_code_of_provider'</span>,</span></span>
<span class="r-in"><span>  event_date <span class="op">=</span> <span class="st">'ev_date'</span>,</span></span>
<span class="r-in"><span>  ae_arrive <span class="op">=</span> <span class="st">'arrival_date'</span>,</span></span>
<span class="r-in"><span>  ae_depart <span class="op">=</span> <span class="st">'departure_date'</span>,</span></span>
<span class="r-in"><span>  ae_discharge <span class="op">=</span> <span class="st">'ecds_discharge'</span>,</span></span>
<span class="r-in"><span>  in_spell_start <span class="op">=</span> <span class="st">'spell_start_date'</span>,</span></span>
<span class="r-in"><span>  in_spell_end <span class="op">=</span> <span class="st">'spell_end_date'</span>,</span></span>
<span class="r-in"><span>  in_discharge <span class="op">=</span> <span class="st">'discharge_destination'</span></span></span>
<span class="r-in"><span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Alex Bhattacharya, Alice Graham, Harshana Liyanage, Frederick Sloots, Emma Parker.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

